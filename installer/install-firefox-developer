#!/bin/bash

echo 'INSTRUCTIONS:'
echo 'Put the extracted "firefox" folder in the same folder as this script.'
echo 'Allow this script to be run as application.'
echo 'Run this script as super-user in a terminal window.'

echo '~#~'

if [ "$EUID" -ne 0 ]; then
    echo 'Warning: No super-user authorization. Proceeding with unprivileged-user instalation'
    echo "Installing Firefox Developer Edition to $HOME/.local/share/"
  
    INSTALL_LOCATION=$HOME/.local/share
    BIN_LOCATION=$HOME/.local
    ICON_LOCATION=$HOME/.local/share
    APP_LOCATION=$HOME/.local
  
  else
    echo 'Warning: Super-user authorized. Proceeding with super-user instalation'
    echo 'Installing Firefox Developer Edition to /opt/'
  
    INSTALL_LOCATION=/opt
    BIN_LOCATION=/usr
    ICON_LOCATION=/usr/share/app-info
    APP_LOCATION=/usr
fi

echo "Moving files to $INSTALL_LOCATION"
mv ./firefox $INSTALL_LOCATION/firefox-dev
ln -s $INSTALL_LOCATION/firefox-dev/firefox $BIN_LOCATION/bin/firefox-developer

echo "Linking icon to $ICON_LOCATION"
mkdir -p $ICON_LOCATION/icons/firefox-dev/128x128
ln -s $INSTALL_LOCATION/firefox-dev/browser/chrome/icons/default/default128.png $ICON_LOCATION/icons/firefox-dev/128x128/firefox-dev-icon.png

echo "Creating Desktop file to $APP_LOCATION"
cp ./firefox-dev.desktop $APP_LOCATION/share/applications/

echo '~#~'

echo 'Done!'
echo 'Please restart your session if there are any visible errors.'
